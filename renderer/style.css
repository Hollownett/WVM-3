:root { color-scheme: dark; --bg:#0b0b0c; --panel:#121216; --muted:#898b93; --fg:#f2f2f5; --accent:#6ea8fe; --ok:#49c989; --danger:#ff5d5d; --border:#22232a; }

*{ box-sizing: border-box; }
html, body { height:100%; }
body {
  margin:0;
  font-family: ui-sans-serif, system-ui, Segoe UI, Roboto, Arial;
  background:linear-gradient(180deg,#0b0b0c,#0e0e12);
  color:var(--fg);
  display:flex;
  flex-direction:column;
}

.titlebar { height:40px; background:rgba(20,20,26,.65); border-bottom:1px solid var(--border); }
.titlebar .drag-region { display:flex; align-items:center; justify-content:space-between; height:100%; padding:0 8px; }
.titlebar .app-title { font-weight:600; letter-spacing:.3px; opacity:.9; }
.title-actions { -webkit-app-region: no-drag; display:flex; gap:6px; }
.ghost { background:transparent; border:1px solid var(--border); color:var(--fg); border-radius:8px; padding:4px 8px; cursor:pointer; }
.danger { background:transparent; border:1px solid var(--danger); color:var(--danger); border-radius:8px; padding:4px 10px; cursor:pointer; }

.controls { padding:12px; display:flex; gap:24px; }
.inputs { flex:1; display:flex; flex-direction:column; gap:12px; }
.field-group { display:flex; flex-direction:column; gap:6px; }
.field { display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
.options { width:230px; display:flex; flex-direction:column; gap:8px; }
.switch { display:flex; align-items:center; gap:8px; }
.switch input { width:18px; height:18px; }
.opacity-field { display:flex; align-items:center; gap:8px; margin-top:8px; }

button, select, input[type="range"] {
  background:#17171c; color:var(--fg); border:1px solid var(--border);
  border-radius:10px; padding:8px 10px; outline:none;
}
button:hover { filter:brightness(1.06); }
.icon-btn { padding:6px 8px; font-size:14px; }

.hint { margin-top:6px; color:var(--muted); font-size:12px; }

#stage { flex:1; position:relative; padding:0; }
#viewport {
  position:absolute;
  top:0;
  left:0;
  right:0;
  bottom:0;
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
}

/* Compact polish */
.compact #controls { display:none; }

.debug { padding: 0 12px 12px; }
#debugLog { background:#0c0c10; border:1px solid var(--border); padding:10px; border-radius:10px; max-height:220px; overflow:auto; }
.dbg-tools { display:flex; gap:8px; margin:6px 0; }

#loading {
  position:fixed;
  left:0;
  right:0;
  bottom:0;
  top:40px;
  display:none;
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,0.5);
  z-index:999;
  font-size:20px;
  backdrop-filter:blur(2px);
}

/* Ensure embedded viewport is fully interactive */
#viewport, .viewport, #embed, .embed {
  -webkit-app-region: no-drag !important;
  pointer-events: auto !important;
  position: relative;
  z-index: 1;
}

/* Overlays should never swallow clicks */
#overlay, .overlay, #loading, .loading {
  pointer-events: none !important;
}

/* Restrict drag regions to explicit header elements */
.drag-region { -webkit-app-region: drag; }
.title-actions, .title-actions * { -webkit-app-region: no-drag; }